{% extends "base.html" %}
{% block title %}근골격계 증상 조사표 (001){% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <h2 class="mb-4">근골격계 증상 조사표 (001_musculoskeletal_symptom_survey)</h2>
            
            <form method="POST" action="{{ url_for('survey.musculoskeletal_symptom_survey') }}">
                {{ form.hidden_tag() }}
                
                <!-- 기본 정보 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">I. 기본 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="employee_number">사번</label>
                                    <input type="text" class="form-control" name="employee_number" id="employee_number" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="name">성명 <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="name" id="name" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="age">나이 <span class="text-danger">*</span></label>
                                    <input type="number" class="form-control" name="age" id="age" min="18" max="100" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>성별</label>
                                    <div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="gender" id="gender_male" value="남">
                                            <label class="form-check-label" for="gender_male">남</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="gender" id="gender_female" value="여">
                                            <label class="form-check-label" for="gender_female">여</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="department">작업부서</label>
                                    <input type="text" class="form-control" name="department" id="department">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="position">직위</label>
                                    <input type="text" class="form-control" name="position" id="position">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>현 직장 근무경력</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" name="work_years" placeholder="년" min="0">
                                        <input type="number" class="form-control" name="work_months" placeholder="개월" min="0" max="11">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="work_type">작업형태</label>
                                    <input type="text" class="form-control" name="work_type" id="work_type">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 작업 정보 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">II. 작업 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="work_hours_per_day">1일 근무시간 (시간)</label>
                                    <input type="number" class="form-control" name="work_hours_per_day" id="work_hours_per_day" min="1" max="24">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="work_days_per_week">주 근무일수</label>
                                    <input type="number" class="form-control" name="work_days_per_week" id="work_days_per_week" min="1" max="7">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="overtime_hours">초과근무 시간 (주당)</label>
                                    <input type="number" class="form-control" name="overtime_hours" id="overtime_hours" min="0">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="work_description">주요 작업 내용</label>
                            <textarea class="form-control" name="work_description" id="work_description" rows="3"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 증상 정보 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">III. 근골격계 증상</h5>
                    </div>
                    <div class="card-body">
                        <p class="mb-3"><strong>최근 1년간 다음 부위에 아픔, 쑤시는 느낌, 저린느낌 등이 있었습니까?</strong></p>
                        
                        {% set body_parts = ['목', '어깨', '팔/팔꿈치', '손목/손가락', '허리', '다리/무릎', '발목/발가락'] %}
                        
                        {% for part in body_parts %}
                        <div class="mb-3">
                            <h6 class="text-primary">{{ part }} 부위</h6>
                            <div class="form-group">
                                <label>증상 유무:</label>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="{{ part }}_symptom" value="yes" id="{{ part }}_yes">
                                    <label class="form-check-label" for="{{ part }}_yes">있음</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="{{ part }}_symptom" value="no" id="{{ part }}_no">
                                    <label class="form-check-label" for="{{ part }}_no">없음</label>
                                </div>
                            </div>
                            
                            <div id="{{ part }}_details" style="display: none;">
                                <div class="row mt-2">
                                    <div class="col-md-6">
                                        <label for="{{ part }}_pain_level">통증 정도 (0-10)</label>
                                        <div class="pain-scale">
                                            {% for i in range(11) %}
                                            <input type="radio" name="{{ part }}_pain_level" value="{{ i }}" id="{{ part }}_pain_{{ i }}">
                                            <label for="{{ part }}_pain_{{ i }}">{{ i }}</label>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="{{ part }}_frequency">발생 빈도</label>
                                        <select class="form-select" name="{{ part }}_frequency">
                                            <option value="">선택하세요</option>
                                            <option value="매일">매일</option>
                                            <option value="주 3-4회">주 3-4회</option>
                                            <option value="주 1-2회">주 1-2회</option>
                                            <option value="월 1-2회">월 1-2회</option>
                                            <option value="드물게">드물게</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- 기타 정보 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0">IV. 기타 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="past_injury">과거 근골격계 질환 또는 상해 경험</label>
                            <textarea class="form-control" name="past_injury" id="past_injury" rows="2"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="exercise_habits">운동 습관</label>
                            <textarea class="form-control" name="exercise_habits" id="exercise_habits" rows="2"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="improvement_suggestions">개선사항 건의</label>
                            <textarea class="form-control" name="improvement_suggestions" id="improvement_suggestions" rows="3"></textarea>
                        </div>
                    </div>
                </div>

                <div class="text-center mb-4">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="bi bi-check-circle"></i> 제출하기
                    </button>
                    <a href="{{ url_for('main.index') }}" class="btn btn-secondary btn-lg ms-2">
                        <i class="bi bi-arrow-left"></i> 취소
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 증상 유무에 따라 상세 정보 표시/숨김
    const bodyParts = ['목', '어깨', '팔/팔꿈치', '손목/손가락', '허리', '다리/무릎', '발목/발가락'];
    
    bodyParts.forEach(function(part) {
        const yesRadio = document.getElementById(part + '_yes');
        const noRadio = document.getElementById(part + '_no');
        const detailsDiv = document.getElementById(part + '_details');
        
        if (yesRadio && noRadio && detailsDiv) {
            yesRadio.addEventListener('change', function() {
                if (this.checked) {
                    detailsDiv.style.display = 'block';
                }
            });
            
            noRadio.addEventListener('change', function() {
                if (this.checked) {
                    detailsDiv.style.display = 'none';
                }
            });
        }
    });
});
</script>
{% endblock %}