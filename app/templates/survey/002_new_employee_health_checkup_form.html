{% extends "base.html" %}
{% block title %}신규 입사자 건강검진 양식 (002){% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <h2 class="mb-4">신규 입사자 건강검진 양식 (002_new_employee_health_checkup_form)</h2>
            
            <form method="POST" action="{{ url_for('survey.new_employee_health_checkup_form') }}">
                {{ form.hidden_tag() }}
                
                <!-- 기본 정보 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">I. 기본 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="employee_number">사번 <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="employee_number" id="employee_number" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="name">성명 <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="name" id="name" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="age">나이 <span class="text-danger">*</span></label>
                                    <input type="number" class="form-control" name="age" id="age" min="18" max="100" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>성별 <span class="text-danger">*</span></label>
                                    <div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="gender" id="gender_male" value="남" required>
                                            <label class="form-check-label" for="gender_male">남</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="gender" id="gender_female" value="여" required>
                                            <label class="form-check-label" for="gender_female">여</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="department">배정부서</label>
                                    <input type="text" class="form-control" name="department" id="department">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="position">직위</label>
                                    <input type="text" class="form-control" name="position" id="position">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="hire_date">입사예정일</label>
                                    <input type="date" class="form-control" name="hire_date" id="hire_date">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 신체 정보 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">II. 신체 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="height_cm">신장 (cm)</label>
                                    <input type="number" class="form-control" name="height_cm" id="height_cm" min="100" max="250" step="0.1">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="weight_kg">체중 (kg)</label>
                                    <input type="number" class="form-control" name="weight_kg" id="weight_kg" min="30" max="200" step="0.1">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="blood_type">혈액형</label>
                                    <select class="form-select" name="blood_type" id="blood_type">
                                        <option value="">선택하세요</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="O">O</option>
                                        <option value="AB">AB</option>
                                        <option value="unknown">모름</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="vision_left">시력 (좌)</label>
                                    <input type="number" class="form-control" name="vision_left" id="vision_left" min="0" max="2.0" step="0.1">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="vision_right">시력 (우)</label>
                                    <input type="number" class="form-control" name="vision_right" id="vision_right" min="0" max="2.0" step="0.1">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="hearing_left">청력 (좌)</label>
                                    <select class="form-select" name="hearing_left">
                                        <option value="">선택하세요</option>
                                        <option value="정상">정상</option>
                                        <option value="경도난청">경도난청</option>
                                        <option value="중등도난청">중등도난청</option>
                                        <option value="고도난청">고도난청</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="hearing_right">청력 (우)</label>
                                    <select class="form-select" name="hearing_right">
                                        <option value="">선택하세요</option>
                                        <option value="정상">정상</option>
                                        <option value="경도난청">경도난청</option>
                                        <option value="중등도난청">중등도난청</option>
                                        <option value="고도난청">고도난청</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="blood_pressure">혈압 (수축기/이완기)</label>
                                    <input type="text" class="form-control" name="blood_pressure" id="blood_pressure" placeholder="예: 120/80">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 기존 질환 이력 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">III. 기존 질환 및 의료 이력</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-group mb-3">
                            <label for="existing_conditions">기존 질환 (있는 경우 상세히 기입)</label>
                            <textarea class="form-control" name="existing_conditions" id="existing_conditions" rows="3" placeholder="고혈압, 당뇨병, 심장질환, 간질환, 신장질환, 근골격계질환 등"></textarea>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="medication_history">복용 중인 약물</label>
                            <textarea class="form-control" name="medication_history" id="medication_history" rows="2" placeholder="현재 복용 중인 처방약이나 건강보조식품"></textarea>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="allergy_history">알레르기 이력</label>
                            <textarea class="form-control" name="allergy_history" id="allergy_history" rows="2" placeholder="음식, 약물, 환경 알레르기 등"></textarea>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="surgery_history">수술 이력</label>
                            <textarea class="form-control" name="surgery_history" id="surgery_history" rows="2" placeholder="과거 받은 수술이나 시술"></textarea>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label>가족력</label>
                            <div class="form-check-group">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="family_history" value="고혈압" id="family_hypertension">
                                    <label class="form-check-label" for="family_hypertension">고혈압</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="family_history" value="당뇨병" id="family_diabetes">
                                    <label class="form-check-label" for="family_diabetes">당뇨병</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="family_history" value="심장질환" id="family_heart">
                                    <label class="form-check-label" for="family_heart">심장질환</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="family_history" value="암" id="family_cancer">
                                    <label class="form-check-label" for="family_cancer">암</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="family_history" value="기타" id="family_other">
                                    <label class="form-check-label" for="family_other">기타</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 생활 습관 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">IV. 생활 습관</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label>흡연 상태</label>
                                    <div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="smoking_status" value="비흡연" id="smoking_never">
                                            <label class="form-check-label" for="smoking_never">비흡연</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="smoking_status" value="금연" id="smoking_quit">
                                            <label class="form-check-label" for="smoking_quit">금연</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="smoking_status" value="흡연" id="smoking_current">
                                            <label class="form-check-label" for="smoking_current">흡연</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group mb-3" id="smoking_details" style="display: none;">
                                    <label for="smoking_amount">일일 흡연량 (개비)</label>
                                    <input type="number" class="form-control" name="smoking_amount" id="smoking_amount" min="0">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label>음주 상태</label>
                                    <div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="drinking_status" value="금주" id="drinking_never">
                                            <label class="form-check-label" for="drinking_never">금주</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="drinking_status" value="가끔" id="drinking_sometimes">
                                            <label class="form-check-label" for="drinking_sometimes">가끔</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="drinking_status" value="정기적" id="drinking_regular">
                                            <label class="form-check-label" for="drinking_regular">정기적</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group mb-3" id="drinking_details" style="display: none;">
                                    <label for="drinking_amount">주당 음주량 (잔)</label>
                                    <input type="number" class="form-control" name="drinking_amount" id="drinking_amount" min="0">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="exercise_habits">운동 습관</label>
                            <textarea class="form-control" name="exercise_habits" id="exercise_habits" rows="2" placeholder="종류, 빈도, 강도 등"></textarea>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="sleep_hours">평균 수면 시간 (시간)</label>
                            <input type="number" class="form-control" name="sleep_hours" id="sleep_hours" min="1" max="24" step="0.5">
                        </div>
                    </div>
                </div>

                <!-- 업무 관련 건강 체크 섹션 -->
                <div class="card mb-4">
                    <div class="card-header bg-danger text-white">
                        <h5 class="mb-0">V. 업무 적합성 평가</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-group mb-3">
                            <label>업무 수행에 영향을 줄 수 있는 신체적 제약사항</label>
                            <div class="form-check-group">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="physical_limitations" value="중량물 취급 제한" id="limit_heavy">
                                    <label class="form-check-label" for="limit_heavy">중량물 취급 제한</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="physical_limitations" value="장시간 서서 작업 제한" id="limit_standing">
                                    <label class="form-check-label" for="limit_standing">장시간 서서 작업 제한</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="physical_limitations" value="고소 작업 제한" id="limit_height">
                                    <label class="form-check-label" for="limit_height">고소 작업 제한</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="physical_limitations" value="화학물질 노출 제한" id="limit_chemical">
                                    <label class="form-check-label" for="limit_chemical">화학물질 노출 제한</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="physical_limitations" value="소음 환경 제한" id="limit_noise">
                                    <label class="form-check-label" for="limit_noise">소음 환경 제한</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="physical_limitations" value="없음" id="limit_none">
                                    <label class="form-check-label" for="limit_none">없음</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="special_considerations">특별히 주의해야 할 사항</label>
                            <textarea class="form-control" name="special_considerations" id="special_considerations" rows="3"></textarea>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="emergency_contact">응급 연락처</label>
                            <input type="text" class="form-control" name="emergency_contact" id="emergency_contact" placeholder="이름: 홍길동, 관계: 배우자, 연락처: 010-1234-5678">
                        </div>
                    </div>
                </div>

                <div class="text-center mb-4">
                    <button type="submit" class="btn btn-info btn-lg">
                        <i class="bi bi-check-circle"></i> 제출하기
                    </button>
                    <a href="{{ url_for('main.index') }}" class="btn btn-secondary btn-lg ms-2">
                        <i class="bi bi-arrow-left"></i> 취소
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 흡연 상태에 따라 상세 정보 표시/숨김
    const smokingRadios = document.querySelectorAll('input[name="smoking_status"]');
    const smokingDetails = document.getElementById('smoking_details');
    
    smokingRadios.forEach(function(radio) {
        radio.addEventListener('change', function() {
            if (this.value === '흡연') {
                smokingDetails.style.display = 'block';
            } else {
                smokingDetails.style.display = 'none';
            }
        });
    });
    
    // 음주 상태에 따라 상세 정보 표시/숨김
    const drinkingRadios = document.querySelectorAll('input[name="drinking_status"]');
    const drinkingDetails = document.getElementById('drinking_details');
    
    drinkingRadios.forEach(function(radio) {
        radio.addEventListener('change', function() {
            if (this.value === '정기적') {
                drinkingDetails.style.display = 'block';
            } else {
                drinkingDetails.style.display = 'none';
            }
        });
    });
});
</script>
{% endblock %}