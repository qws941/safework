name: SafeWork Auto Issue Detection

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  detect-claude-requests:
    if: contains(github.event.comment.body, '@claude')
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - name: Detect Claude Request
        uses: actions/github-script@v7
        with:
          script: |
            const comment = context.payload.comment;
            const isClaudeRequest = comment.body.includes('@claude');
            
            if (isClaudeRequest) {
              // Add claude label
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: ['claude-request']
              });
              
              // Create response comment
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                body: \`ğŸ¤– Claude AI ìš”ì²­ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤! 

**SafeWork ì‚°ì—…ë³´ê±´ì•ˆì „ ì‹œìŠ¤í…œ ì „ë¬¸ê°€**ë¡œì„œ ë„ì›€ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

ğŸ“‹ **ë„ë©”ì¸ ì „ë¬¸ì„±:**
- ì˜ë£Œ/ë³´ê±´: ê·¼ê³¨ê²©ê³„ ì„¤ë¬¸(001), ì‹ ê·œì ê±´ê°•ê²€ì§„(002)
- ê¸°ìˆ ìŠ¤íƒ: Flask 3.0+, MySQL 8.0, Redis, Docker
- 13ê°œ SafeWork ê´€ë¦¬íŒ¨ë„ ì‹œìŠ¤í…œ

âš ï¸ **ì°¸ê³ **: í˜„ì¬ comment ì´ë²¤íŠ¸ì—ì„œëŠ” ì œí•œëœ ê¸°ëŠ¥ë§Œ ì œê³µë©ë‹ˆë‹¤. 
ì „ì²´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ìƒˆë¡œìš´ Issueë‚˜ PRì„ ìƒì„±í•˜ê³  \\\`@claude\\\` ë©˜ì…˜ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.

ğŸ” **ë¶„ì„ ì¤‘**: \${comment.body}

ë” ìƒì„¸í•œ ë„ì›€ì´ í•„ìš”í•˜ì‹œë©´ ìƒˆ Issueë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”! ğŸš€\`
              });
            }

      - name: Update Memory
        run: |
          echo "Claude request detected and processed for SafeWork project"
          echo "Comment ID: \${{ github.event.comment.id }}"
          echo "Issue/PR: #\${{ github.event.issue.number || github.event.pull_request.number }}"