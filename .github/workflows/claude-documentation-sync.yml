name: SafeWork ë¬¸ì„œ ìë™ ë™ê¸°í™”

on:
  push:
    branches: [main, master]
    paths:
      - 'app/**/*.py'
      - 'app/templates/**'
      - 'README.md'
      - 'CLAUDE.md'
      - '.claude/**'
  pull_request:
    types: [opened, synchronize, reopened]
  schedule:
    - cron: '0 3 * * 0'  # ë§¤ì£¼ ì¼ìš”ì¼ 12:00 KST ë¬¸ì„œ ë™ê¸°í™”
  workflow_dispatch:
    inputs:
      documentation_scope:
        description: 'ë¬¸ì„œí™” ë²”ìœ„'
        required: true
        default: 'incremental'
        type: choice
        options:
        - 'incremental'  # ë³€ê²½ì‚¬í•­ë§Œ
        - 'comprehensive'  # ì „ì²´ ì¬ìƒì„±
        - 'api_only'  # API ë¬¸ì„œë§Œ
        - 'user_guide'  # ì‚¬ìš©ì ê°€ì´ë“œë§Œ

env:
  TIMEZONE: 'Asia/Seoul'
  PYTHON_VERSION: '3.11'

jobs:
  documentation_sync:
    name: ğŸ“š SafeWork ë¬¸ì„œ ë™ê¸°í™”
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    permissions:
      contents: write
      issues: write
      pull-requests: write
      
    steps:
      - name: ğŸ“¥ ì†ŒìŠ¤ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # ì „ì²´ íˆìŠ¤í† ë¦¬ í•„ìš” (ë¬¸ì„œ ë³€ê²½ì¶”ì ìš©)
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: ğŸ Python í™˜ê²½ ì„¤ì •
        uses: actions/setup-python@v4
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'
          
      - name: ğŸ“¦ ë¬¸ì„œí™” ë„êµ¬ ì„¤ì¹˜
        run: |
          pip install --upgrade pip
          pip install -r app/requirements.txt
          pip install sphinx sphinx-rtd-theme sphinx-autodoc-typehints
          pip install pydoc-markdown mkdocs-material
          
      - name: ğŸ” ì½”ë“œ ë³€ê²½ì‚¬í•­ ë¶„ì„
        id: changes
        run: |
          echo "ğŸ“Š ë¬¸ì„œ ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ë³€ê²½ì‚¬í•­ ë¶„ì„..."
          
          # Python íŒŒì¼ ë³€ê²½ ê°ì§€
          PYTHON_CHANGES=$(git diff --name-only HEAD~1 HEAD | grep '\.py$' | wc -l)
          TEMPLATE_CHANGES=$(git diff --name-only HEAD~1 HEAD | grep 'templates/' | wc -l)
          DOC_CHANGES=$(git diff --name-only HEAD~1 HEAD | grep -E '\.(md|rst)$' | wc -l)
          
          echo "python_changes=$PYTHON_CHANGES" >> $GITHUB_OUTPUT
          echo "template_changes=$TEMPLATE_CHANGES" >> $GITHUB_OUTPUT
          echo "doc_changes=$DOC_CHANGES" >> $GITHUB_OUTPUT
          
          echo "ğŸ“ˆ ë³€ê²½ì‚¬í•­ ìš”ì•½:"
          echo "  Python íŒŒì¼: $PYTHON_CHANGESê°œ"
          echo "  í…œí”Œë¦¿ íŒŒì¼: $TEMPLATE_CHANGESê°œ"
          echo "  ë¬¸ì„œ íŒŒì¼: $DOC_CHANGESê°œ"
          
      - name: ğŸ”„ API ë¬¸ì„œ ìë™ ìƒì„±
        if: steps.changes.outputs.python_changes > 0 || github.event.inputs.documentation_scope == 'comprehensive' || github.event.inputs.documentation_scope == 'api_only'
        run: |
          echo "ğŸ“– SafeWork API ë¬¸ì„œ ìë™ ìƒì„±..."
          cd app
          
          python3 << 'EOF'
          import os, inspect, importlib.util
          from datetime import datetime
          
          def generate_api_doc():
              api_doc = []
              api_doc.append("# SafeWork API ë¬¸ì„œ")
              api_doc.append("")
              api_doc.append(f"**ìƒì„±ì¼ì‹œ**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S KST')}")
              api_doc.append("**ìë™ìƒì„±**: GitHub Actionsë¥¼ í†µí•œ ìë™ ë¬¸ì„œí™”")
              api_doc.append("")
              
              # routes ë””ë ‰í† ë¦¬ì˜ ëª¨ë“  Python íŒŒì¼ ìŠ¤ìº”
              routes_dir = "routes"
              if os.path.exists(routes_dir):
                  api_doc.append("## ğŸŒ API ì—”ë“œí¬ì¸íŠ¸")
                  api_doc.append("")
                  
                  for file in os.listdir(routes_dir):
                      if file.endswith('.py') and not file.startswith('__'):
                          module_name = file[:-3]
                          api_doc.append(f"### {module_name.title()} ëª¨ë“ˆ")
                          api_doc.append("")
                          
                          try:
                              # íŒŒì¼ ë‚´ìš© ì½ê¸°ë¡œ ë¼ìš°íŠ¸ ì •ë³´ ì¶”ì¶œ
                              with open(f"{routes_dir}/{file}", 'r', encoding='utf-8') as f:
                                  content = f.read()
                                  
                              # @route ë°ì½”ë ˆì´í„° ì°¾ê¸°
                              import re
                              routes = re.findall(r"@\w+\.route\(['\"](.*?)['\"](?:,.*?)?\)", content)
                              
                              for route in routes:
                                  api_doc.append(f"- `{route}`")
                              
                              api_doc.append("")
                          except Exception as e:
                              api_doc.append(f"  *ë¬¸ì„œí™” ì¤‘ ì˜¤ë¥˜: {e}*")
                              api_doc.append("")
              
              # models.py ìŠ¤ìº”
              if os.path.exists("models.py"):
                  api_doc.append("## ğŸ—„ï¸ ë°ì´í„° ëª¨ë¸")
                  api_doc.append("")
                  
                  with open("models.py", 'r', encoding='utf-8') as f:
                      content = f.read()
                  
                  # í´ë˜ìŠ¤ ì •ì˜ ì°¾ê¸°
                  import re
                  classes = re.findall(r"class (\w+)\(.*?\):", content)
                  
                  for class_name in classes:
                      api_doc.append(f"### {class_name}")
                      api_doc.append("")
                      
                      # í´ë˜ìŠ¤ ë‚´ í•„ë“œ ì°¾ê¸° (ê°„ë‹¨í•œ íŒ¨í„´ ë§¤ì¹­)
                      class_pattern = rf"class {class_name}.*?(?=class|\Z)"
                      class_match = re.search(class_pattern, content, re.DOTALL)
                      if class_match:
                          class_content = class_match.group(0)
                          fields = re.findall(r"(\w+)\s*=\s*db\.Column", class_content)
                          
                          if fields:
                              api_doc.append("**í•„ë“œ**:")
                              for field in fields:
                                  api_doc.append(f"- `{field}`")
                          api_doc.append("")
              
              return "\n".join(api_doc)
          
          # API ë¬¸ì„œ ìƒì„±
          doc_content = generate_api_doc()
          
          # ë¬¸ì„œ ì €ì¥
          with open("../docs/API.md", "w", encoding='utf-8') as f:
              f.write(doc_content)
          
          print("âœ… API ë¬¸ì„œ ìë™ ìƒì„± ì™„ë£Œ")
          EOF
          
      - name: ğŸ“‹ ì‚¬ìš©ì ê°€ì´ë“œ ì—…ë°ì´íŠ¸
        if: steps.changes.outputs.template_changes > 0 || github.event.inputs.documentation_scope == 'comprehensive' || github.event.inputs.documentation_scope == 'user_guide'
        run: |
          echo "ğŸ“– SafeWork ì‚¬ìš©ì ê°€ì´ë“œ ìƒì„±..."
          
          mkdir -p docs
          
          cat > docs/USER_GUIDE.md << 'EOF'
          # SafeWork ì‚¬ìš©ì ê°€ì´ë“œ
          
          **ìµœì¢… ì—…ë°ì´íŠ¸**: $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M:%S KST')
          
          ## ğŸ¥ SafeWork ì‹œìŠ¤í…œ ê°œìš”
          
          SafeWorkëŠ” ì‚°ì—…ì•ˆì „ë³´ê±´ ê´€ë¦¬ë¥¼ ìœ„í•œ ì›¹ ê¸°ë°˜ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
          
          ### ì£¼ìš” ê¸°ëŠ¥
          - ğŸ” **ì„¤ë¬¸ì¡°ì‚¬ 001**: ê·¼ê³¨ê²©ê³„ ì¦ìƒ ì¡°ì‚¬
          - ğŸ©º **ì„¤ë¬¸ì¡°ì‚¬ 002**: ì‹ ê·œì…ì‚¬ì ê±´ê°•ê²€ì§„
          - ğŸ“Š **ê´€ë¦¬ì íŒ¨ë„**: SafeWork ê´€ë¦¬ ì‹œìŠ¤í…œ (13ê°œ ëª¨ë“ˆ)
          - ğŸ“„ **ë¬¸ì„œ ê´€ë¦¬**: ë²„ì „ ê´€ë¦¬ê°€ í¬í•¨ëœ ë¬¸ì„œ ì‹œìŠ¤í…œ
          
          ## ğŸš€ ì‹œì‘í•˜ê¸°
          
          ### ì ‘ì† ë°©ë²•
          - **ìš´ì˜ í™˜ê²½**: https://safewokr.jclee.me
          - **ê°œë°œ í™˜ê²½**: http://localhost:4545
          
          ### ê³„ì • ìƒì„±
          1. íšŒì›ê°€ì… í˜ì´ì§€ ì ‘ì†
          2. í•„ìˆ˜ ì •ë³´ ì…ë ¥
          3. ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ
          4. ë¡œê·¸ì¸ í›„ ì´ìš© ì‹œì‘
          
          ## ğŸ“‹ ì„¤ë¬¸ì¡°ì‚¬ ì´ìš©ë°©ë²•
          
          ### ì„¤ë¬¸ì¡°ì‚¬ 001 (ê·¼ê³¨ê²©ê³„)
          1. ë©”ì¸í˜ì´ì§€ì—ì„œ "ì„¤ë¬¸ì¡°ì‚¬ 001" í´ë¦­
          2. ê°œì¸ì •ë³´ ì…ë ¥ (ìµëª… ê°€ëŠ¥)
          3. ê·¼ê³¨ê²©ê³„ ì¦ìƒ ë¬¸í•­ ì‘ë‹µ
          4. ì œì¶œ ì™„ë£Œ í›„ ê²°ê³¼ í™•ì¸
          
          ### ì„¤ë¬¸ì¡°ì‚¬ 002 (ê±´ê°•ê²€ì§„)
          1. "ì„¤ë¬¸ì¡°ì‚¬ 002" ë©”ë‰´ ì„ íƒ
          2. ê±´ê°•ê²€ì§„ ê´€ë ¨ ì •ë³´ ì…ë ¥
          3. ê¸°ì¡´ ì§ˆí™˜ ë° ì•½ë¬¼ë³µìš© í˜„í™© ì‘ì„±
          4. ìµœì¢… ê²€í†  í›„ ì œì¶œ
          
          ## ğŸ‘¨â€ğŸ’¼ ê´€ë¦¬ì ê¸°ëŠ¥
          
          ### SafeWork ê´€ë¦¬íŒ¨ë„ ì ‘ì†
          - URL: `/admin/safework`
          - ê´€ë¦¬ì ê¶Œí•œ í•„ìš”
          - 13ê°œ ì „ë¬¸ ê´€ë¦¬ ëª¨ë“ˆ ì œê³µ
          
          ### ì£¼ìš” ê´€ë¦¬ ê¸°ëŠ¥
          - ğŸ‘¥ **ê·¼ë¡œì ê´€ë¦¬**: ì§ì› ì •ë³´ ë“±ë¡/ìˆ˜ì •
          - ğŸ¥ **ê±´ê°•ê²€ì§„**: ê²€ì§„ ê²°ê³¼ ê´€ë¦¬
          - ğŸ’Š **ì˜ì•½í’ˆ ê´€ë¦¬**: ì¬ê³  ë° ìœ í†µê¸°í•œ ê´€ë¦¬
          - ğŸ“Š **í†µê³„ ë¶„ì„**: ì„¤ë¬¸ ê²°ê³¼ ë¶„ì„ ë¦¬í¬íŠ¸
          
          ## ğŸ”’ ë³´ì•ˆ ë° ê°œì¸ì •ë³´
          
          ### ê°œì¸ê±´ê°•ì •ë³´ ë³´í˜¸
          - ëª¨ë“  ê±´ê°•ì •ë³´ëŠ” ì•”í˜¸í™” ì €ì¥
          - ì ‘ê·¼ ê¶Œí•œ ì—„ê²© ê´€ë¦¬
          - ë²•ì  ìš”êµ¬ì‚¬í•­ ì™„ì „ ì¤€ìˆ˜
          
          ### ë°ì´í„° ë³´ê´€ ì •ì±…
          - ì„¤ë¬¸ ë°ì´í„°: 5ë…„ ë³´ê´€
          - ê±´ê°•ê²€ì§„ ë°ì´í„°: ë²•ì • ë³´ê´€ê¸°ê°„ ì¤€ìˆ˜
          - ê°œì¸ì‹ë³„ì •ë³´: ìµœì†Œí•œ ìˆ˜ì§‘ ì›ì¹™
          
          ## ğŸ†˜ ë„ì›€ë§ ë° ì§€ì›
          
          ### ê¸°ìˆ  ì§€ì›
          - GitHub Issues: https://github.com/qws941/safework/issues
          - ê´€ë¦¬ì ë¬¸ì˜: safework@company.com
          
          ### ìì£¼ ë¬»ëŠ” ì§ˆë¬¸
          1. **Q: ì„¤ë¬¸ ì¤‘ ë¸Œë¼ìš°ì €ê°€ ë‹«í˜”ì–´ìš”**
             A: ì„ì‹œì €ì¥ ê¸°ëŠ¥ìœ¼ë¡œ ì´ì–´ì„œ ì‘ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤.
          
          2. **Q: ì œì¶œí•œ ì„¤ë¬¸ì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‚˜ìš”?**
             A: ì œì¶œ í›„ì—ëŠ” ìˆ˜ì • ë¶ˆê°€í•˜ë‹ˆ ì‹ ì¤‘íˆ ì‘ì„±í•´ì£¼ì„¸ìš”.
          
          3. **Q: ê°œì¸ì •ë³´ëŠ” ì•ˆì „í•œê°€ìš”?**
             A: ëª¨ë“  ë°ì´í„°ëŠ” ì•”í˜¸í™”ë˜ì–´ ì•ˆì „í•˜ê²Œ ë³´ê´€ë©ë‹ˆë‹¤.
          
          ---
          ğŸ“š *SafeWork Documentation - ìë™ ìƒì„±ë¨*
          EOF
          
      - name: ğŸ¤– Claude ë¬¸ì„œ ì „ë¬¸ê°€ ë™ê¸°í™”
        uses: anthropics/claude-code-action@v1.0.5
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          github_token: ${{ secrets.GITHUB_TOKEN }}
          track_progress: true
          use_sticky_comment: true
          claude_args: |
            --max-turns 8
            --model claude-3-5-sonnet-20241022
            --timeout 600
          prompt: |
            # ğŸ“š SafeWork ë¬¸ì„œí™” ì „ë¬¸ê°€
            
            ë‹¹ì‹ ì€ **SafeWork ì‚°ì—…ì•ˆì „ ì‹œìŠ¤í…œì˜ ë¬¸ì„œí™” ì „ë¬¸ê°€**ì…ë‹ˆë‹¤.
            
            ## ğŸ“– SafeWork ë¬¸ì„œí™” ì»¨í…ìŠ¤íŠ¸
            - **ëŒ€ìƒ ë…ì**: ê°œë°œì, ì‹œìŠ¤í…œ ê´€ë¦¬ì, ìµœì¢… ì‚¬ìš©ì
            - **ë¬¸ì„œ ìœ í˜•**: API ë¬¸ì„œ, ì‚¬ìš©ì ê°€ì´ë“œ, ê¸°ìˆ  ëª…ì„¸ì„œ
            - **ì—…ë°ì´íŠ¸ ì£¼ê¸°**: ì½”ë“œ ë³€ê²½ ì‹œ ìë™, ì£¼ê°„ ì •ê¸° ê²€í† 
            
            ## ğŸ¯ ë¬¸ì„œí™” ëª©í‘œ
            1. **ì½”ë“œ ë³€ê²½ì‚¬í•­ ë°˜ì˜** - ìë™ ê°ì§€ëœ ë³€ê²½ì‚¬í•­ì„ ë¬¸ì„œì— ë°˜ì˜
            2. **ì‚¬ìš©ì ê²½í—˜ ê°œì„ ** - ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ ë¬¸ì„œ ì‘ì„±
            3. **ë¬¸ì„œ ì¼ê´€ì„± ìœ ì§€** - ì „ì²´ ë¬¸ì„œì˜ ìŠ¤íƒ€ì¼ê³¼ êµ¬ì¡° í†µì¼
            4. **ìµœì‹ ì„± ë³´ì¥** - ì½”ë“œì™€ ë¬¸ì„œ ê°„ ë¶ˆì¼ì¹˜ ì œê±°
            
            ## ğŸ“‹ ë¬¸ì„œí™” ì‘ì—… ë²”ìœ„
            
            ### ë³€ê²½ì‚¬í•­ ê¸°ë°˜ ì—…ë°ì´íŠ¸
            - Python íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.python_changes }}ê°œ
            - í…œí”Œë¦¿ íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.template_changes }}ê°œ  
            - ë¬¸ì„œ íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.doc_changes }}ê°œ
            
            ### ë¬¸ì„œí™” ìš°ì„ ìˆœìœ„
            1. **High**: API ì—”ë“œí¬ì¸íŠ¸ ë³€ê²½, ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€
            2. **Medium**: UI ë³€ê²½ì‚¬í•­, ì„¤ì • íŒŒë¼ë¯¸í„° ìˆ˜ì •
            3. **Low**: ë‚´ë¶€ ë¦¬íŒ©í† ë§, ì„±ëŠ¥ ê°œì„ 
            
            ## ğŸ“ ë¬¸ì„œ ì—…ë°ì´íŠ¸ ê°€ì´ë“œë¼ì¸
            
            ### API ë¬¸ì„œ (docs/API.md)
            - ìƒˆë¡œìš´ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€/ë³€ê²½ì‚¬í•­ ë°˜ì˜
            - ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ ì—…ë°ì´íŠ¸
            - ì—ëŸ¬ ì½”ë“œ ë° ì²˜ë¦¬ ë°©ë²• ëª…ì‹œ
            
            ### ì‚¬ìš©ì ê°€ì´ë“œ (docs/USER_GUIDE.md)
            - ìƒˆë¡œìš´ ê¸°ëŠ¥ ì‚¬ìš©ë²• ì¶”ê°€
            - UI ë³€ê²½ì‚¬í•­ ìŠ¤í¬ë¦°ìƒ· ì—…ë°ì´íŠ¸
            - FAQ ì„¹ì…˜ í™•ì¥
            
            ### ê¸°ìˆ  ë¬¸ì„œ
            - ì•„í‚¤í…ì²˜ ë³€ê²½ì‚¬í•­ ë°˜ì˜
            - ì„¤ì¹˜/ë°°í¬ ê°€ì´ë“œ ìµœì‹ í™”
            - ê°œë°œí™˜ê²½ ì„¤ì • ì—…ë°ì´íŠ¸
            
            **ë¬¸ì„œ ë™ê¸°í™” ì‹¤í–‰ ì‹œê°: $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M:%S KST')**
            **ë²”ìœ„**: ${{ github.event.inputs.documentation_scope || 'incremental' }}
            
            SafeWork ì‹œìŠ¤í…œì˜ ì½”ë“œ ë³€ê²½ì‚¬í•­ì„ ë¶„ì„í•˜ì—¬ ê´€ë ¨ ë¬¸ì„œë¥¼ ì—…ë°ì´íŠ¸í•˜ê³ , ì‚¬ìš©ìê°€ ì´í•´í•˜ê¸° ì‰¬ìš´ ë¬¸ì„œë¡œ ê°œì„ í•´ì£¼ì„¸ìš”. íŠ¹íˆ ì‚°ì—…ì•ˆì „ ë„ë©”ì¸ ìš©ì–´ì™€ í•œêµ­ì–´ ì‚¬ìš©ìë¥¼ ê³ ë ¤í•œ ë¬¸ì„œí™”ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”.
            
      - name: ğŸ“Š ë¬¸ì„œ í’ˆì§ˆ ê²€ì‚¬
        run: |
          echo "ğŸ” ë¬¸ì„œ í’ˆì§ˆ ë° ì¼ê´€ì„± ê²€ì‚¬..."
          
          # ë§ˆí¬ë‹¤ìš´ íŒŒì¼ ê²€ì‚¬
          find . -name "*.md" -type f | while read file; do
              echo "ê²€ì‚¬ ì¤‘: $file"
              
              # ê¸°ë³¸ ë§ˆí¬ë‹¤ìš´ ë¬¸ë²• ê²€ì‚¬
              if grep -q "^#" "$file"; then
                  echo "  âœ… í—¤ë” êµ¬ì¡° í™•ì¸"
              else
                  echo "  âš ï¸  í—¤ë”ê°€ ì—†ìŠµë‹ˆë‹¤"
              fi
              
              # í•œê¸€ ì¸ì½”ë”© ê²€ì‚¬
              if file "$file" | grep -q "UTF-8"; then
                  echo "  âœ… UTF-8 ì¸ì½”ë”© í™•ì¸"
              else
                  echo "  âš ï¸  ì¸ì½”ë”© ë¬¸ì œ ê°€ëŠ¥ì„±"
              fi
          done
          
          echo "ğŸ“ˆ ë¬¸ì„œ í†µê³„:"
          echo "  ì´ ë§ˆí¬ë‹¤ìš´ íŒŒì¼: $(find . -name "*.md" | wc -l)ê°œ"
          echo "  ë¬¸ì„œ ì´ ë¼ì¸ ìˆ˜: $(find . -name "*.md" -exec wc -l {} + | tail -1 | awk '{print $1}')"
          
      - name: ğŸ’¾ ë¬¸ì„œ ë³€ê²½ì‚¬í•­ ì»¤ë°‹
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          
          # ë¬¸ì„œ ë³€ê²½ì‚¬í•­ì´ ìˆëŠ”ì§€ í™•ì¸
          if git diff --quiet; then
              echo "ğŸ“„ ë¬¸ì„œ ë³€ê²½ì‚¬í•­ ì—†ìŒ"
          else
              echo "ğŸ“ ë¬¸ì„œ ë³€ê²½ì‚¬í•­ ì»¤ë°‹..."
              git add docs/
              git add -A "*.md"
              
              git commit -m "ğŸ“š ë¬¸ì„œ ìë™ ë™ê¸°í™” $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M KST')

          ğŸ¤– Generated with SafeWork Documentation Pipeline
          
          - ë²”ìœ„: ${{ github.event.inputs.documentation_scope || 'incremental' }}
          - Python íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.python_changes }}ê°œ
          - í…œí”Œë¦¿ íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.template_changes }}ê°œ
          - ìë™ ìƒì„±: API ë¬¸ì„œ, ì‚¬ìš©ì ê°€ì´ë“œ"
              
              git push
              echo "âœ… ë¬¸ì„œ ë³€ê²½ì‚¬í•­ í‘¸ì‹œ ì™„ë£Œ"
          fi
          
      - name: ğŸ“„ ë¬¸ì„œí™” ë¦¬í¬íŠ¸ ìƒì„±
        if: always()
        run: |
          cat > documentation-sync-report.md << 'EOF'
          # ğŸ“š SafeWork ë¬¸ì„œ ë™ê¸°í™” ë¦¬í¬íŠ¸
          
          **ë™ê¸°í™” ì¼ì‹œ**: $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M:%S KST')
          **ë™ê¸°í™” ë²”ìœ„**: ${{ github.event.inputs.documentation_scope || 'incremental' }}
          **íŠ¸ë¦¬ê±° ì´ë²¤íŠ¸**: ${{ github.event_name }}
          
          ## ğŸ“Š ë³€ê²½ì‚¬í•­ ìš”ì•½
          - Python íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.python_changes }}ê°œ
          - í…œí”Œë¦¿ íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.template_changes }}ê°œ
          - ë¬¸ì„œ íŒŒì¼ ë³€ê²½: ${{ steps.changes.outputs.doc_changes }}ê°œ
          
          ## âœ… ì™„ë£Œëœ ì‘ì—…
          - ğŸ“– API ë¬¸ì„œ ìë™ ìƒì„±
          - ğŸ“‹ ì‚¬ìš©ì ê°€ì´ë“œ ì—…ë°ì´íŠ¸
          - ğŸ” ë¬¸ì„œ í’ˆì§ˆ ê²€ì‚¬
          - ğŸ¤– Claude ë¬¸ì„œ ì „ë¬¸ê°€ ê²€í† 
          
          ## ğŸ“ˆ ë¬¸ì„œ í˜„í™©
          - ì´ ë§ˆí¬ë‹¤ìš´ íŒŒì¼: $(find . -name "*.md" | wc -l)ê°œ
          - ë¬¸ì„œí™” ì»¤ë²„ë¦¬ì§€: [Claude ë¶„ì„ ê²°ê³¼]
          
          ---
          ğŸ“š *SafeWork Documentation Sync Pipeline*
          EOF
          
      - name: ğŸ“¤ ë¬¸ì„œí™” ê²°ê³¼ ì—…ë¡œë“œ
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: safework-documentation-reports
          path: |
            documentation-sync-report.md
            docs/
          retention-days: 30