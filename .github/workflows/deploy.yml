name: ğŸš€ SafeWork Deploy Pipeline

# Prevent concurrent deployments on the same branch
concurrency:
  group: deploy-${{ github.ref_name }}
  cancel-in-progress: true

on:
  push:
    branches: [master]
    paths:
      - 'app/**'
      - 'postgres/**'
      - 'redis/**'
      - '.github/workflows/deploy.yml'
  
  workflow_dispatch:

env:
  APP_NAME: ${{ secrets.APP_NAME }}
  REGISTRY_HOST: ${{ secrets.REGISTRY_HOST }}
  REGISTRY_USER: ${{ secrets.REGISTRY_USER }}
  REGISTRY_PASSWORD: ${{ secrets.REGISTRY_PASSWORD }}
  TZ: Asia/Seoul
  PRD_URL: https://${{ secrets.APP_NAME }}.jclee.me
  DEV_URL: https://${{ secrets.APP_NAME }}-dev.jclee.me
  PORTAINER_URL: ${{ secrets.PORTAINER_URL }}
  WATCHTOWER_URL: ${{ secrets.WATCHTOWER_URL }}

permissions:
  contents: write
  actions: write
  pull-requests: write
  issues: write
  packages: write
  security-events: write
  checks: write
  statuses: write
  deployments: write
  discussions: write
  repository-projects: write
  id-token: write

jobs:
  # Phase 1: Build and Test Independent Containers
  build-and-test:
    name: ğŸ”¨ Build & Test Independent Containers
    runs-on: ubuntu-latest
    outputs:
      app_image_tag: ${{ steps.app_meta.outputs.tags }}
      postgres_image_tag: ${{ steps.postgres_meta.outputs.tags }}
      redis_image_tag: ${{ steps.redis_meta.outputs.tags }}
      test_results: ${{ steps.test.outputs.results }}
      build_status: ${{ steps.build.outputs.build_status }}
      
    steps:
      - name: ğŸ“‚ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ³ Setup Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: ğŸ” Login to Registry  
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY_HOST }}
          username: ${{ env.REGISTRY_USER }}
          password: ${{ env.REGISTRY_PASSWORD }}

      # Metadata for PostgreSQL image
      - name: ğŸ“‹ Extract PostgreSQL Metadata
        id: postgres_meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY_HOST }}/${{ env.APP_NAME }}/postgres
          tags: |
            type=raw,value=latest

      # Metadata for Redis image
      - name: ğŸ“‹ Extract Redis Metadata
        id: redis_meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY_HOST }}/${{ env.APP_NAME }}/redis
          tags: |
            type=raw,value=latest

      # Metadata for App image
      - name: ğŸ“‹ Extract App Metadata
        id: app_meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY_HOST }}/${{ env.APP_NAME }}/app
          tags: |
            type=raw,value=latest

      # Build PostgreSQL Container (Independent)
      - name: ğŸ˜ Build & Push PostgreSQL Container
        uses: docker/build-push-action@v5
        with:
          context: ./postgres
          file: ./postgres/Dockerfile
          push: true
          tags: ${{ steps.postgres_meta.outputs.tags }}
          labels: ${{ steps.postgres_meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          platforms: linux/amd64

      # Build Redis Container (Independent)
      - name: ğŸ”´ Build & Push Redis Container
        uses: docker/build-push-action@v5
        with:
          context: ./redis
          file: ./redis/Dockerfile
          push: true
          tags: ${{ steps.redis_meta.outputs.tags }}
          labels: ${{ steps.redis_meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          platforms: linux/amd64

      # Build App Container (Independent)
      - name: ğŸ Build & Push App Container
        uses: docker/build-push-action@v5
        with:
          context: ./app
          file: ./app/Dockerfile
          push: true
          tags: ${{ steps.app_meta.outputs.tags }}
          labels: ${{ steps.app_meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          platforms: linux/amd64

      # Test independent containers connectivity
      - name: ğŸ§ª Test Independent Container Connectivity
        id: test
        run: |
          echo "Testing independent container connectivity..."
          
          # Test PostgreSQL container independently
          docker run --rm --name test-postgres -d \
            -e POSTGRES_PASSWORD=${{ secrets.POSTGRES_PASSWORD }} \
            -e POSTGRES_DB=${{ secrets.POSTGRES_DB }} \
            -e POSTGRES_USER=${{ secrets.POSTGRES_USER }} \
            -p 5432:5432 \
            ${{ steps.postgres_meta.outputs.tags }}
          
          sleep 15
          
          # Test Redis container independently
          docker run --rm --name test-redis -d \
            -p 6379:6379 \
            ${{ steps.redis_meta.outputs.tags }}
          
          sleep 10
          
          # Test App container with environment variables for independent execution
          docker run --rm --name test-app -d \
            -e DB_HOST=host.docker.internal \
            -e DB_PORT=5432 \
            -e REDIS_HOST=host.docker.internal \
            -e REDIS_PORT=6379 \
            -e SECRET_KEY=test-secret \
            -e POSTGRES_PASSWORD=${{ secrets.POSTGRES_PASSWORD }} \
            -e POSTGRES_DB=${{ secrets.POSTGRES_DB }} \
            -e POSTGRES_USER=${{ secrets.POSTGRES_USER }} \
            -p 4545:4545 \
            ${{ steps.app_meta.outputs.tags }}
          
          sleep 20
          
          # Test connectivity between containers
          echo "Testing container connectivity..."
          
          # Test PostgreSQL connectivity
          docker exec test-app pg_isready -h host.docker.internal -p 5432 || echo "PostgreSQL connection test warning"
          
          # Test Redis connectivity  
          docker exec test-app redis-cli -h host.docker.internal -p 6379 ping || echo "Redis connection test warning"
          
          echo "Container connectivity test completed"
          
          # Keep containers running for log analysis on error
          if [[ "${GITHUB_ACTIONS_DEBUG:-false}" == "true" ]]; then
            echo "ğŸ” DEBUG MODE: Keeping containers running for log analysis"
            echo "Container logs available via:"
            echo "  docker logs test-postgres"
            echo "  docker logs test-redis"
            echo "  docker logs test-app"
          else
            # Cleanup test containers in normal mode
            docker stop test-postgres test-redis test-app || true
            docker rm test-postgres test-redis test-app || true
          fi
          
          echo "results=success" >> $GITHUB_OUTPUT
          echo "build_status=success" >> $GITHUB_OUTPUT

  # Phase 2: Deploy via Watchtower (Independent Architecture)
  deploy:
    name: ğŸš€ Deploy via Watchtower
    runs-on: ubuntu-latest
    needs: build-and-test
    if: success() || github.event.inputs.force_deploy == 'true'
    outputs:
      deployment_status: ${{ steps.deploy.outputs.status }}
      deployment_url: ${{ steps.deploy.outputs.url }}
      
    steps:
      - name: ğŸ“‚ Checkout
        uses: actions/checkout@v4

      - name: ğŸš€ Trigger Watchtower Auto-Deploy
        id: deploy
        run: |
          echo "ğŸš€ Starting SafeWork Watchtower auto-deployment..."
          
          # Check Watchtower HTTP API token
          if [[ -z "${{ secrets.WATCHTOWER_HTTP_API_TOKEN }}" ]]; then
            echo "âŒ WATCHTOWER_HTTP_API_TOKEN is not configured"
            echo "status=failed" >> $GITHUB_OUTPUT
            exit 1
          fi
          
          echo "ğŸ“¡ Updating SafeWork containers via Watchtower HTTP API..."
          echo "Registry: ${{ env.REGISTRY_HOST }}"
          echo "App Name: ${{ env.APP_NAME }}"
          
          # Call Watchtower API to update all SafeWork containers
          WATCHTOWER_RESPONSE=$(curl -X POST \
            -H "Authorization: Bearer ${{ secrets.WATCHTOWER_HTTP_API_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d "{\"containers\": [\"safework-postgres\", \"safework-redis\", \"safework-app\"]}" \
            "${{ env.WATCHTOWER_URL }}/v1/update" \
            -w "%{http_code}" -s)
          
          RESPONSE_CODE="${WATCHTOWER_RESPONSE: -3}"
          RESPONSE_BODY="${WATCHTOWER_RESPONSE%???}"
          
          echo "Watchtower response code: $RESPONSE_CODE"
          echo "Watchtower response body: $RESPONSE_BODY"
          
          if [[ "$RESPONSE_CODE" == "200" || "$RESPONSE_CODE" == "202" ]]; then
            echo "âœ… Watchtower auto-deployment successfully triggered"
            echo "ğŸ“¦ PostgreSQL: ${{ env.REGISTRY_HOST }}/${{ env.APP_NAME }}/postgres:latest"
            echo "ğŸ“¦ Redis: ${{ env.REGISTRY_HOST }}/${{ env.APP_NAME }}/redis:latest" 
            echo "ğŸ“¦ App: ${{ env.REGISTRY_HOST }}/${{ env.APP_NAME }}/app:latest"
            echo "status=success" >> $GITHUB_OUTPUT
          else
            echo "âŒ Watchtower API call failed: $RESPONSE_CODE"
            echo "status=failed" >> $GITHUB_OUTPUT
            exit 1
          fi
          
          # Wait for deployment
          echo "â³ Waiting for container restart (45 seconds)..."
          sleep 45
          
          echo "status=success" >> $GITHUB_OUTPUT
          echo "url=${{ env.PRD_URL }}" >> $GITHUB_OUTPUT

      - name: ğŸ¥ Health Check with Retry
        id: health
        run: |
          echo "ğŸ¥ Checking SafeWork application status..."
          
          # Health check with extended retry for independent containers
          for i in {1..15}; do
            echo "ğŸ” Health check attempt $i/15..."
            
            if curl -f -s -m 10 "${{ env.PRD_URL }}/health" > /dev/null; then
              echo "âœ… SafeWork application running normally"
              echo "ğŸŒ Production URL: ${{ env.PRD_URL }}"
              echo "health_status=healthy" >> $GITHUB_OUTPUT
              exit 0
            fi
            
            echo "â³ Waiting 20 seconds before retry..."
            sleep 20
          done
          
          echo "âŒ Health check failed after 15 attempts"
          echo "health_status=unhealthy" >> $GITHUB_OUTPUT
          
          # Keep containers running for log analysis
          echo "ğŸ” Containers remain running for log analysis:"
          echo "  - Access Portainer: https://portainer.jclee.me"
          echo "  - Container logs: ${{ env.APP_NAME }}-postgres, ${{ env.APP_NAME }}-redis, ${{ env.APP_NAME }}-app"
          echo "  - Production URL: ${{ env.PRD_URL }}"
          
          exit 1

      - name: ğŸ” Container Debug Information
        if: failure()
        run: |
          echo "ğŸ” Container Debug Information for Log Analysis:"
          
          # Wait for containers to fully start
          sleep 30
          
          echo "ğŸ“‹ Container Status via Watchtower API:"
          if [[ -n "${{ secrets.WATCHTOWER_HTTP_API_TOKEN }}" ]]; then
            CONTAINER_STATUS=$(curl -s \
              -H "Authorization: Bearer ${{ secrets.WATCHTOWER_HTTP_API_TOKEN }}" \
              "${{ env.WATCHTOWER_URL }}/v1/containers" || echo "API call failed")
            echo "$CONTAINER_STATUS"
          fi
          
          echo ""
          echo "ğŸ¥ Direct Health Check Results:"
          echo "App Health: $(curl -s -o /dev/null -w '%{http_code}' '${{ env.PRD_URL }}/health' || echo 'unreachable')"
          echo "App Status: $(curl -s '${{ env.PRD_URL }}/health' || echo 'connection failed')"
          
          echo ""
          echo "ğŸ“Š Container Log Analysis Available via Portainer:"
          echo "- Portainer URL: https://portainer.jclee.me"
          echo "- Target containers: ${{ env.APP_NAME }}-postgres, ${{ env.APP_NAME }}-redis, ${{ env.APP_NAME }}-app"
          echo "- Production URL: ${{ env.PRD_URL }}"

      - name: ğŸ”„ Optional Rollback (Manual Control)
        if: failure()
        run: |
          echo "ğŸš¨ Deployment failure detected"
          
          # Optional rollback - can be disabled for debugging
          if [[ "${AUTO_ROLLBACK_DISABLED:-false}" != "true" ]]; then
            echo "ğŸ“¡ Executing automatic rollback via Watchtower..."
            
            if [[ -n "${{ secrets.WATCHTOWER_HTTP_API_TOKEN }}" ]]; then
              ROLLBACK_RESPONSE=$(curl -X POST \
                -H "Authorization: Bearer ${{ secrets.WATCHTOWER_HTTP_API_TOKEN }}" \
                -H "Content-Type: application/json" \
                -d "{\"containers\": [\"safework-postgres\", \"safework-redis\", \"safework-app\"], \"rollback\": true}" \
                "${{ env.WATCHTOWER_URL }}/v1/update" \
                -w "%{http_code}" -s)
              
              ROLLBACK_CODE="${ROLLBACK_RESPONSE: -3}"
              echo "Rollback response code: $ROLLBACK_CODE"
              
              if [[ "$ROLLBACK_CODE" == "200" || "$ROLLBACK_CODE" == "202" ]]; then
                echo "âœ… Watchtower rollback successful"
              else
                echo "âš ï¸ Watchtower rollback failed: $ROLLBACK_CODE"
              fi
            else
              echo "âš ï¸ WATCHTOWER_HTTP_API_TOKEN not configured"
            fi
          else
            echo "ğŸ” AUTO_ROLLBACK_DISABLED=true - Containers kept running for log analysis"
            echo "ğŸ“Š Manual rollback available via Watchtower: ${{ env.WATCHTOWER_URL }}"
          fi
          
          echo "ğŸ”„ Rollback process completed"

  # Phase 3: Notification and Monitoring
  notify:
    name: ğŸ“¢ Deployment Notification
    runs-on: ubuntu-latest
    needs: [build-and-test, deploy]
    if: always()
    
    steps:
      - name: ğŸ“Š Deployment Summary
        run: |
          echo "=== SafeWork Deployment Complete ===" 
          echo "Build Status: ${{ needs.build-and-test.outputs.build_status }}"
          echo "Deploy Status: ${{ needs.deploy.outputs.deployment_status }}"
          echo "Application URL: ${{ needs.deploy.outputs.deployment_url }}"
          echo "Deploy Time: $(date)"
          
          # Check container status
          echo ""
          echo "=== Container Status ===" 
          echo "SafeWork PostgreSQL: ${{ env.APP_NAME }}-postgres:4544"
          echo "SafeWork Redis: ${{ env.APP_NAME }}-redis:4546" 
          echo "SafeWork App: ${{ env.APP_NAME }}-app:4545"

      - name: ğŸ› Create Issue on Deployment Failure
        if: failure()
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const title = `ğŸš¨ SafeWork Deployment Failure - ${new Date().toISOString()}`;
            const body = `
            ## ğŸš¨ SafeWork Production Deployment Failed
            
            **Deployment Information:**
            - Branch: ${{ github.ref_name }}
            - Commit: ${{ github.sha }}
            - Workflow: ${{ github.workflow }}
            - Run ID: ${{ github.run_id }}
            
            **Failure Stage:**
            - Build Status: ${{ needs.build-and-test.outputs.build_status }}
            - Deploy Status: ${{ needs.deploy.outputs.deployment_status }}
            
            **Container Ports:**
            - ${{ env.APP_NAME }}-postgres: 4544
            - ${{ env.APP_NAME }}-redis: 4546
            - ${{ env.APP_NAME }}-app: 4545
            
            **Required Actions:**
            - [ ] Check build logs
            - [ ] Inspect container status  
            - [ ] Analyze health check results
            - [ ] Determine manual rollback necessity
            
            **Log Review:**
            https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
            `;
            
            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: title,
              body: body,
              labels: ['deployment-failure', 'claude-actionable', '${{ env.APP_NAME }}']
            });

      - name: ğŸ‰ Deployment Success Notification
        if: success()
        run: |
          echo "ğŸ‰ SafeWork deployment successful!"
          echo "Production URL: ${{ env.PRD_URL }}"
          echo "Health check: ${{ env.PRD_URL }}/health"
          echo "Admin panel: ${{ env.PRD_URL }}/admin"
          echo "Survey: ${{ env.PRD_URL }}/survey/001_musculoskeletal_symptom_survey"

      - name: ğŸš€ Advanced Post-Deployment Analysis & Optimization Engine
        if: success() && github.event_name == 'workflow_dispatch'
        uses: anthropics/claude-code-action@v1
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          anthropic_api_key: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          track_progress: true
          prompt: |
            ğŸš€ **SafeWork ê³ ê¸‰ ë°°í¬ í›„ ë¶„ì„ ë° ìµœì í™” ì—”ì§„**
            
            **ğŸ“Š ë°°í¬ ì„±ê³¼ ë¶„ì„:**
            - Build Status: ${{ needs.build-and-test.outputs.build_status }}
            - Deploy Status: ${{ needs.deploy.outputs.deployment_status }}
            - Application URL: ${{ needs.deploy.outputs.deployment_url }}
            - Deployment Time: $(date)
            - Container Architecture: Independent containers (PostgreSQL:4544, Redis:4546, App:4545)
            
            **ğŸ¯ ê³ ê¸‰ MCP ë„êµ¬ í†µí•© ë¶„ì„:**
            
            1. **ğŸ§  Sequential Thinking**: ë°°í¬ ì„±ê³µ/ì‹¤íŒ¨ íŒ¨í„´ ì‹¬ì¸µ ë¶„ì„
               - ì„±ê³µ ìš”ì¸ ì‹ë³„ ë° íŒ¨í„´í™”
               - ì ì¬ì  ìœ„í—˜ ìš”ì†Œ ì‚¬ì „ íƒì§€
               - ì„±ëŠ¥ ìµœì í™” ê¸°íšŒ ë°œêµ´
            
            2. **ğŸ“‹ Shrimp Task Manager**: ì‹œìŠ¤í…œ ê°œì„  ë¡œë“œë§µ ìƒì„±
               - ë‹¤ìŒ ë°°í¬ ì£¼ê¸° ìµœì í™” ì‘ì—… ê³„íš
               - ìë™í™” í™•ì¥ ê°€ëŠ¥ì„± í‰ê°€
               - ë³´ì•ˆ ê°•í™” ì‘ì—… ìš°ì„ ìˆœìœ„í™”
            
            3. **ğŸ” Serena Code Analysis**: ì½”ë“œë² ì´ìŠ¤ ê±´ê°•ë„ ë¶„ì„
               - ì•„í‚¤í…ì²˜ ì¼ê´€ì„± ê²€ì¦
               - ì½”ë“œ í’ˆì§ˆ ë©”íŠ¸ë¦­ í‰ê°€
               - ë¦¬íŒ©í„°ë§ í•„ìš” ì˜ì—­ ì‹ë³„
            
            4. **ğŸ”— GitHub Integration**: ì´ìŠˆ ë° PR ìë™ ê´€ë¦¬
               - ì„±ê³µì ì¸ ë°°í¬ì— ëŒ€í•œ ìë™ ì´ìŠˆ í´ë¡œì§•
               - ê°œì„  ì œì•ˆì‚¬í•­ ì´ìŠˆ ìƒì„±
               - PR ë¦¬ë·° í’ˆì§ˆ ë¶„ì„
            
            5. **ğŸ’¾ Memory System**: ë°°í¬ íŒ¨í„´ í•™ìŠµ ë° ì €ì¥
               - ì„±ê³µì ì¸ ë°°í¬ ì „ëµ íŒ¨í„´ ì €ì¥
               - ì‹¤íŒ¨ ì›ì¸ ë¶„ì„ ê²°ê³¼ ë³´ê´€
               - í–¥í›„ ë°°í¬ë¥¼ ìœ„í•œ ì§€ì‹ ì¶•ì 
            
            **ğŸ¥ ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ ìƒíƒœ ëª¨ë‹ˆí„°ë§:**
            - Portainer APIë¥¼ í†µí•œ ì»¨í…Œì´ë„ˆ ìƒíƒœ ë¶„ì„
            - ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
            - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ìƒíƒœ ë° ì¿¼ë¦¬ ì„±ëŠ¥ ì ê²€
            - Redis ìºì‹œ íš¨ìœ¨ì„± ë¶„ì„
            - ë©”ëª¨ë¦¬ ë° CPU ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§
            
            **âš¡ ìë™ ìµœì í™” ìˆ˜í–‰:**
            - ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ í• ë‹¹ ìµœì í™” ì œì•ˆ
            - ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ìµœì í™” ë¶„ì„
            - ìºì‹œ ì „ëµ ê°œì„ ì•ˆ ë„ì¶œ
            - ë³´ì•ˆ ì„¤ì • ê°•í™” ë°©ì•ˆ ì œì‹œ
            - ë¡œê·¸ ë¶„ì„ì„ í†µí•œ ì„±ëŠ¥ ë³‘ëª© ì§€ì  ì‹ë³„
            
            **ğŸ” ë³´ì•ˆ ë° ì»´í”Œë¼ì´ì–¸ìŠ¤ ì ê²€:**
            - ì‚°ì—… ì•ˆì „ ê´€ë¦¬ ì‹œìŠ¤í…œ ê·œì • ì¤€ìˆ˜ ê²€ì¦
            - ì·¨ì•½ì  ìŠ¤ìº” ê²°ê³¼ ë¶„ì„
            - ì ‘ê·¼ ì œì–´ ë° ê¶Œí•œ ê´€ë¦¬ ì ê²€
            - ë°ì´í„° ë³´í˜¸ ë° ê°œì¸ì •ë³´ ì²˜ë¦¬ ê²€í† 
            
            **ğŸ“ˆ ì„±ê³¼ ì§€í‘œ ë° ê°œì„  ê¶Œì¥ì‚¬í•­:**
            - ë°°í¬ ì†ë„ ë° ì•ˆì •ì„± ë©”íŠ¸ë¦­
            - ì‚¬ìš©ì ê²½í—˜ ê°œì„  í¬ì¸íŠ¸
            - ì‹œìŠ¤í…œ í™•ì¥ì„± í‰ê°€
            - ë¹„ìš© ìµœì í™” ë°©ì•ˆ
            - ê°œë°œíŒ€ ìƒì‚°ì„± í–¥ìƒ ì œì•ˆ
            
            **ğŸ¯ ì‹¤í–‰ í”„ë¡œí† ì½œ:**
            1. MCP ë„êµ¬ë¥¼ í™œìš©í•œ ì¢…í•© ìƒíƒœ ë¶„ì„
            2. ì‹¤ì‹œê°„ ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° í‰ê°€
            3. ë³´ì•ˆ ë° ì»´í”Œë¼ì´ì–¸ìŠ¤ ìë™ ì ê²€
            4. ìµœì í™” ê¸°íšŒ ì‹ë³„ ë° ìš°ì„ ìˆœìœ„í™”
            5. êµ¬ì²´ì ì¸ ê°œì„  ì‘ì—… ê³„íš ìˆ˜ë¦½
            6. GitHub ì´ìŠˆë¡œ ì¶”ì  ê°€ëŠ¥í•œ íƒœìŠ¤í¬ ìƒì„±
            7. í•™ìŠµëœ íŒ¨í„´ì„ Memory Systemì— ì €ì¥
            
            **ğŸ’¬ ë³´ê³ ì„œ ì‘ì„± ìš”êµ¬ì‚¬í•­:**
            - í•œêµ­ì–´ë¡œ ìƒì„¸í•œ ë¶„ì„ ê²°ê³¼ ì œê³µ
            - êµ¬ì²´ì ì´ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ ê°œì„ ì•ˆ ì œì‹œ
            - ìš°ì„ ìˆœìœ„ê°€ ëª…í™•í•œ ì•¡ì…˜ ì•„ì´í…œ ìƒì„±
            - ë‹¤ìŒ ë°°í¬ë¥¼ ìœ„í•œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì œê³µ
            - ì¥ê¸°ì ì¸ ì‹œìŠ¤í…œ ë°œì „ ë°©í–¥ ì œì‹œ
            
            ì¦‰ì‹œ ê³ ê¸‰ ë¶„ì„ì„ ì‹œì‘í•˜ê³  SafeWork ì‹œìŠ¤í…œì˜ ì§€ì†ì ì¸ ê°œì„ ì„ ìœ„í•œ í¬ê´„ì ì¸ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.