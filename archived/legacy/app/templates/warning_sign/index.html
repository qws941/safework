<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeWork 경고 표지 생성기 - 화학물질 GHS 라벨 제작</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom Styles -->
    <style>
        [v-cloak] { display: none; }

        .ghs-pictogram {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .ghs-pictogram:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .ghs-pictogram.selected {
            border: 3px solid #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }

        .warning-sign-preview {
            background: white;
            border: 3px solid #dc2626;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            min-height: 400px;
        }

        .gradient-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" v-cloak>
        <!-- Header -->
        <header class="gradient-header text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-shield-alt text-3xl"></i>
                        <div>
                            <h1 class="text-2xl font-bold">SafeWork 경고 표지 생성기</h1>
                            <p class="text-sm opacity-90">GHS 및 KOSHA 표준 화학물질 경고 라벨</p>
                        </div>
                    </div>
                    <div class="flex space-x-4">
                        <button @click="currentView = 'editor'"
                                class="px-4 py-2 rounded-lg transition"
                                :class="currentView === 'editor' ? 'bg-white text-purple-700' : 'bg-purple-600 hover:bg-purple-700'">
                            <i class="fas fa-edit mr-2"></i>편집기
                        </button>
                        <button @click="currentView = 'gallery'"
                                class="px-4 py-2 rounded-lg transition"
                                :class="currentView === 'gallery' ? 'bg-white text-purple-700' : 'bg-purple-600 hover:bg-purple-700'">
                            <i class="fas fa-images mr-2"></i>갤러리
                        </button>
                        <button @click="currentView = 'templates'"
                                class="px-4 py-2 rounded-lg transition"
                                :class="currentView === 'templates' ? 'bg-white text-purple-700' : 'bg-purple-600 hover:bg-purple-700'">
                            <i class="fas fa-layer-group mr-2"></i>템플릿
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-8">
            <!-- Editor View -->
            <div v-if="currentView === 'editor'" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Panel - Configuration -->
                <div class="space-y-6">
                    <!-- Basic Information -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                            기본 정보
                        </h2>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    제품명/화학물질명 *
                                </label>
                                <input v-model="sign.title"
                                       type="text"
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                       placeholder="예: 염화수소 (Hydrochloric Acid)">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    설명 (선택사항)
                                </label>
                                <textarea v-model="sign.description"
                                          rows="3"
                                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                          placeholder="제품에 대한 추가 설명"></textarea>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        종횡비
                                    </label>
                                    <select v-model="sign.aspect_ratio"
                                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                        <option value="1:1">1:1 (정사각형)</option>
                                        <option value="1:1.2">1:1.2</option>
                                        <option value="1:1.5">1:1.5</option>
                                        <option value="1:2">1:2</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        언어
                                    </label>
                                    <select v-model="sign.language"
                                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                        <option value="ko">한국어</option>
                                        <option value="en">English</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- GHS Pictograms -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
                            GHS 픽토그램
                        </h2>

                        <div v-if="loading.pictograms" class="text-center py-8">
                            <i class="fas fa-spinner fa-spin text-3xl text-purple-500"></i>
                            <p class="mt-2 text-gray-600">픽토그램 로딩 중...</p>
                        </div>

                        <div v-else class="grid grid-cols-3 sm:grid-cols-4 gap-4">
                            <div v-for="pictogram in pictograms"
                                 :key="pictogram.code"
                                 @click="togglePictogram(pictogram.code)"
                                 class="ghs-pictogram p-3 border-2 rounded-lg"
                                 :class="{'selected': sign.pictograms.includes(pictogram.code)}"
                                 :title="pictogram.name_ko">
                                <div class="aspect-square bg-gray-100 rounded flex items-center justify-center">
                                    <span class="text-2xl">⚠️</span>
                                </div>
                                <p class="text-xs text-center mt-2 font-medium">{{ pictogram.code }}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Signal Word -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-flag text-red-500 mr-2"></i>
                            신호어
                        </h2>

                        <div class="grid grid-cols-3 gap-4">
                            <button @click="sign.signal_word = 'Danger'"
                                    class="px-6 py-3 rounded-lg font-bold transition"
                                    :class="sign.signal_word === 'Danger' ? 'bg-red-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'">
                                위험 (Danger)
                            </button>
                            <button @click="sign.signal_word = 'Warning'"
                                    class="px-6 py-3 rounded-lg font-bold transition"
                                    :class="sign.signal_word === 'Warning' ? 'bg-yellow-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'">
                                경고 (Warning)
                            </button>
                            <button @click="sign.signal_word = null"
                                    class="px-6 py-3 rounded-lg font-bold transition"
                                    :class="!sign.signal_word ? 'bg-gray-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'">
                                없음
                            </button>
                        </div>
                    </div>

                    <!-- Hazard Statements -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-exclamation-circle text-orange-500 mr-2"></i>
                            유해·위험 문구 (H-codes)
                        </h2>

                        <div v-if="loading.hazardStatements" class="text-center py-8">
                            <i class="fas fa-spinner fa-spin text-3xl text-purple-500"></i>
                            <p class="mt-2 text-gray-600">유해성 문구 로딩 중...</p>
                        </div>

                        <div v-else>
                            <div class="mb-4">
                                <input v-model="hazardSearchQuery"
                                       type="text"
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                       placeholder="H-code 또는 문구 검색...">
                            </div>

                            <div class="max-h-64 overflow-y-auto space-y-2">
                                <div v-for="statement in filteredHazardStatements"
                                     :key="statement.code"
                                     @click="toggleHazardStatement(statement)"
                                     class="p-3 border rounded-lg cursor-pointer transition hover:bg-gray-50"
                                     :class="isHazardSelected(statement.code) ? 'border-blue-500 bg-blue-50' : 'border-gray-200'">
                                    <div class="flex items-center justify-between">
                                        <div class="flex-1">
                                            <span class="font-bold text-sm">{{ statement.code }}</span>
                                            <span class="text-sm ml-2">{{ statement.text_ko }}</span>
                                        </div>
                                        <i v-if="isHazardSelected(statement.code)" class="fas fa-check-circle text-blue-500"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Precautionary Statements -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-shield-alt text-blue-500 mr-2"></i>
                            예방 조치 문구 (P-codes)
                        </h2>

                        <div v-if="loading.precautionaryStatements" class="text-center py-8">
                            <i class="fas fa-spinner fa-spin text-3xl text-purple-500"></i>
                            <p class="mt-2 text-gray-600">예방 조치 문구 로딩 중...</p>
                        </div>

                        <div v-else>
                            <div class="mb-4">
                                <select v-model="precautionaryFilter"
                                        class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                    <option value="all">전체</option>
                                    <option value="Prevention">예방</option>
                                    <option value="Response">대응</option>
                                    <option value="Storage">저장</option>
                                    <option value="Disposal">폐기</option>
                                </select>
                            </div>

                            <div class="max-h-64 overflow-y-auto space-y-2">
                                <div v-for="statement in filteredPrecautionaryStatements"
                                     :key="statement.code"
                                     @click="togglePrecautionaryStatement(statement)"
                                     class="p-3 border rounded-lg cursor-pointer transition hover:bg-gray-50"
                                     :class="isPrecautionarySelected(statement.code) ? 'border-green-500 bg-green-50' : 'border-gray-200'">
                                    <div class="flex items-center justify-between">
                                        <div class="flex-1">
                                            <span class="font-bold text-sm">{{ statement.code }}</span>
                                            <span class="text-sm ml-2">{{ statement.text_ko }}</span>
                                            <span class="text-xs text-gray-500 ml-2">({{ statement.category }})</span>
                                        </div>
                                        <i v-if="isPrecautionarySelected(statement.code)" class="fas fa-check-circle text-green-500"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Supplier Information -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-building text-green-500 mr-2"></i>
                            공급자 정보
                        </h2>

                        <div class="space-y-4">
                            <input v-model="sign.supplier_name"
                                   type="text"
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                   placeholder="공급자명">
                            <input v-model="sign.supplier_phone"
                                   type="text"
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                   placeholder="전화번호">
                            <input v-model="sign.emergency_phone"
                                   type="text"
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                   placeholder="비상연락처">
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="space-y-4">
                        <button @click="saveSign"
                                class="w-full bg-purple-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-purple-700 transition">
                            <i class="fas fa-save mr-2"></i>저장
                        </button>

                        <div class="grid grid-cols-3 gap-3">
                            <button @click="exportSign('png')"
                                    class="bg-green-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-green-700 transition text-sm">
                                <i class="fas fa-download mr-1"></i>PNG
                            </button>
                            <button @click="exportSign('pdf')"
                                    class="bg-red-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-red-700 transition text-sm">
                                <i class="fas fa-file-pdf mr-1"></i>PDF
                            </button>
                            <button @click="exportSign('svg')"
                                    class="bg-blue-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-blue-700 transition text-sm">
                                <i class="fas fa-vector-square mr-1"></i>SVG
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Panel - Live Preview -->
                <div class="sticky top-8">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold mb-4 flex items-center justify-between">
                            <span>
                                <i class="fas fa-eye text-purple-500 mr-2"></i>
                                실시간 미리보기
                            </span>
                            <span class="text-sm font-normal text-gray-500">
                                {{ sign.width_mm }}mm × {{ sign.height_mm }}mm
                            </span>
                        </h2>

                        <div class="warning-sign-preview p-8 rounded-lg"
                             :style="{
                                 borderColor: sign.border_color,
                                 borderWidth: sign.border_width + 'px',
                                 backgroundColor: sign.background_color
                             }">
                            <!-- Title -->
                            <div class="text-center mb-6">
                                <h3 class="font-bold" :style="{fontSize: sign.font_size_title + 'px'}">
                                    {{ sign.title || '제품명을 입력하세요' }}
                                </h3>
                            </div>

                            <!-- Pictograms -->
                            <div v-if="sign.pictograms.length > 0" class="flex justify-center space-x-4 mb-6">
                                <div v-for="code in sign.pictograms"
                                     :key="code"
                                     class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center">
                                    <span class="text-2xl">⚠️</span>
                                </div>
                            </div>

                            <!-- Signal Word -->
                            <div v-if="sign.signal_word" class="text-center mb-6">
                                <span class="inline-block px-6 py-2 rounded-lg font-bold text-white text-xl"
                                      :class="sign.signal_word === 'Danger' ? 'bg-red-600' : 'bg-yellow-500'">
                                    {{ sign.language === 'ko' ? (sign.signal_word === 'Danger' ? '위험' : '경고') : sign.signal_word }}
                                </span>
                            </div>

                            <!-- Hazard Statements -->
                            <div v-if="sign.hazard_statements.length > 0" class="mb-6">
                                <h4 class="text-sm font-bold mb-2">유해·위험 문구</h4>
                                <ul class="text-xs space-y-1">
                                    <li v-for="statement in sign.hazard_statements" :key="statement.code">
                                        <span class="font-bold">{{ statement.code }}:</span> {{ sign.language === 'ko' ? statement.text_ko : statement.text_en }}
                                    </li>
                                </ul>
                            </div>

                            <!-- Precautionary Statements -->
                            <div v-if="sign.precautionary_statements.length > 0" class="mb-6">
                                <h4 class="text-sm font-bold mb-2">예방 조치 문구</h4>
                                <ul class="text-xs space-y-1">
                                    <li v-for="statement in sign.precautionary_statements" :key="statement.code">
                                        <span class="font-bold">{{ statement.code }}:</span> {{ sign.language === 'ko' ? statement.text_ko : statement.text_en }}
                                    </li>
                                </ul>
                            </div>

                            <!-- Supplier Info -->
                            <div v-if="sign.supplier_name"
                                 class="mt-8 pt-4 border-t border-gray-300 text-center"
                                 :style="{fontSize: sign.font_size_supplier + 'px'}">
                                <p class="font-medium">{{ sign.supplier_name }}</p>
                                <p v-if="sign.supplier_phone" class="text-gray-600">Tel: {{ sign.supplier_phone }}</p>
                                <p v-if="sign.emergency_phone" class="text-red-600 font-medium">비상: {{ sign.emergency_phone }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gallery View -->
            <div v-if="currentView === 'gallery'" class="space-y-6">
                <h2 class="text-2xl font-bold">공개 경고 표지 갤러리</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition">
                        <p class="text-center text-gray-500 py-8">갤러리 기능 준비 중...</p>
                    </div>
                </div>
            </div>

            <!-- Templates View -->
            <div v-if="currentView === 'templates'" class="space-y-6">
                <h2 class="text-2xl font-bold">사전 구성 템플릿</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition">
                        <p class="text-center text-gray-500 py-8">템플릿 기능 준비 중...</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div v-if="toast.show"
             class="fixed bottom-8 right-8 glass-effect rounded-lg shadow-xl p-4 max-w-md"
             :class="{
                 'border-l-4 border-green-500': toast.type === 'success',
                 'border-l-4 border-red-500': toast.type === 'error',
                 'border-l-4 border-blue-500': toast.type === 'info'
             }">
            <div class="flex items-center">
                <i class="fas text-2xl mr-3"
                   :class="{
                       'fa-check-circle text-green-500': toast.type === 'success',
                       'fa-exclamation-circle text-red-500': toast.type === 'error',
                       'fa-info-circle text-blue-500': toast.type === 'info'
                   }"></i>
                <p class="font-medium">{{ toast.message }}</p>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentView: 'editor', // 'editor', 'gallery', 'templates'

                    sign: {
                        title: '',
                        description: '',
                        aspect_ratio: '1:1',
                        width_mm: 200,
                        height_mm: 200,
                        pictograms: [],
                        signal_word: null,
                        hazard_statements: [],
                        precautionary_statements: [],
                        supplier_name: '',
                        supplier_address: '',
                        supplier_phone: '',
                        emergency_phone: '',
                        font_size_title: 24,
                        font_size_statements: 14,
                        font_size_supplier: 12,
                        background_color: '#FFFFFF',
                        border_color: '#DC2626',
                        border_width: 3,
                        language: 'ko',
                        is_public: false
                    },

                    pictograms: [],
                    hazardStatements: [],
                    precautionaryStatements: [],

                    hazardSearchQuery: '',
                    precautionaryFilter: 'all',

                    loading: {
                        pictograms: true,
                        hazardStatements: true,
                        precautionaryStatements: true
                    },

                    toast: {
                        show: false,
                        message: '',
                        type: 'info'
                    }
                };
            },

            computed: {
                filteredHazardStatements() {
                    if (!this.hazardSearchQuery) return this.hazardStatements;
                    const query = this.hazardSearchQuery.toLowerCase();
                    return this.hazardStatements.filter(s =>
                        s.code.toLowerCase().includes(query) ||
                        s.text_ko.includes(query) ||
                        s.text_en.toLowerCase().includes(query)
                    );
                },

                filteredPrecautionaryStatements() {
                    let statements = this.precautionaryStatements;
                    if (this.precautionaryFilter !== 'all') {
                        statements = statements.filter(s => s.category === this.precautionaryFilter);
                    }
                    return statements;
                }
            },

            mounted() {
                this.loadPictograms();
                this.loadHazardStatements();
                this.loadPrecautionaryStatements();
                this.updateDimensions();
            },

            watch: {
                'sign.aspect_ratio'() {
                    this.updateDimensions();
                }
            },

            methods: {
                async loadPictograms() {
                    try {
                        this.loading.pictograms = true;
                        const response = await fetch('/warning-sign/api/pictograms');
                        const data = await response.json();

                        if (data.success) {
                            this.pictograms = data.data;
                        }
                    } catch (error) {
                        console.error('Error loading pictograms:', error);
                        this.showToast('픽토그램 로딩 실패', 'error');
                    } finally {
                        this.loading.pictograms = false;
                    }
                },

                togglePictogram(code) {
                    const index = this.sign.pictograms.indexOf(code);
                    if (index > -1) {
                        this.sign.pictograms.splice(index, 1);
                    } else {
                        this.sign.pictograms.push(code);
                    }
                },

                async loadHazardStatements() {
                    try {
                        this.loading.hazardStatements = true;
                        const response = await fetch('/warning-sign/api/hazard-statements');
                        const data = await response.json();

                        if (data.success) {
                            this.hazardStatements = data.data;
                        }
                    } catch (error) {
                        console.error('Error loading hazard statements:', error);
                        this.showToast('유해성 문구 로딩 실패', 'error');
                    } finally {
                        this.loading.hazardStatements = false;
                    }
                },

                async loadPrecautionaryStatements() {
                    try {
                        this.loading.precautionaryStatements = true;
                        const response = await fetch('/warning-sign/api/precautionary-statements');
                        const data = await response.json();

                        if (data.success) {
                            this.precautionaryStatements = data.data;
                        }
                    } catch (error) {
                        console.error('Error loading precautionary statements:', error);
                        this.showToast('예방 조치 문구 로딩 실패', 'error');
                    } finally {
                        this.loading.precautionaryStatements = false;
                    }
                },

                toggleHazardStatement(statement) {
                    const existing = this.sign.hazard_statements.find(s => s.code === statement.code);
                    if (existing) {
                        this.sign.hazard_statements = this.sign.hazard_statements.filter(s => s.code !== statement.code);
                    } else {
                        this.sign.hazard_statements.push({
                            code: statement.code,
                            text_ko: statement.text_ko,
                            text_en: statement.text_en
                        });
                    }
                },

                togglePrecautionaryStatement(statement) {
                    const existing = this.sign.precautionary_statements.find(s => s.code === statement.code);
                    if (existing) {
                        this.sign.precautionary_statements = this.sign.precautionary_statements.filter(s => s.code !== statement.code);
                    } else {
                        this.sign.precautionary_statements.push({
                            code: statement.code,
                            text_ko: statement.text_ko,
                            text_en: statement.text_en
                        });
                    }
                },

                isHazardSelected(code) {
                    return this.sign.hazard_statements.some(s => s.code === code);
                },

                isPrecautionarySelected(code) {
                    return this.sign.precautionary_statements.some(s => s.code === code);
                },

                updateDimensions() {
                    const ratio = this.sign.aspect_ratio.split(':').map(Number);
                    this.sign.height_mm = Math.round(this.sign.width_mm * ratio[1] / ratio[0]);
                },

                async saveSign() {
                    try {
                        const response = await fetch('/warning-sign/api/signs', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(this.sign)
                        });

                        const data = await response.json();

                        if (data.success) {
                            this.showToast('경고 표지가 저장되었습니다!', 'success');
                        } else {
                            throw new Error(data.error || '저장 실패');
                        }
                    } catch (error) {
                        console.error('Error saving sign:', error);
                        this.showToast('저장 중 오류가 발생했습니다', 'error');
                    }
                },

                async exportSign(format) {
                    try {
                        // First save the sign
                        const saveResponse = await fetch('/warning-sign/api/signs', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(this.sign)
                        });

                        const saveData = await saveResponse.json();

                        if (!saveData.success) {
                            throw new Error('저장 실패');
                        }

                        const signId = saveData.data.id;

                        // Then export in the requested format
                        window.location.href = `/warning-sign/api/signs/${signId}/export/${format}`;
                        this.showToast(`${format.toUpperCase()} 파일 다운로드 시작`, 'success');
                    } catch (error) {
                        console.error('Export error:', error);
                        this.showToast('내보내기 중 오류가 발생했습니다', 'error');
                    }
                },

                showToast(message, type = 'info') {
                    this.toast = {
                        show: true,
                        message,
                        type
                    };

                    setTimeout(() => {
                        this.toast.show = false;
                    }, 3000);
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
