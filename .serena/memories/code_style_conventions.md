# SafeWork Code Style & Conventions

## Python Code Style
- **Formatter**: Black 23.12.1 for automatic code formatting
- **Linter**: Flake8 7.0.0 for code quality checks
- **Import Style**: Standard library imports first, then third-party, then local imports

## Flask Application Structure
- **Application Factory Pattern**: `create_app()` function in `app/app.py`
- **Blueprint Architecture**: Modular route organization
  - `routes/main.py`: Main application routes
  - `routes/auth.py`: Authentication routes  
  - `routes/survey.py`: Survey-related routes
  - `routes/admin.py`: Admin panel routes
  - `routes/health.py`: Health check endpoints

## File Organization
```
app/
├── app.py              # Application factory and configuration
├── config.py           # Configuration classes
├── models.py           # Database models
├── forms.py            # WTForms form definitions
├── routes/             # Route blueprints
├── templates/          # Jinja2 HTML templates
├── forms/              # PDF form templates
└── requirements.txt    # Python dependencies
```

## Naming Conventions
- **Variables**: snake_case (e.g., `user_id`, `survey_data`)
- **Functions**: snake_case (e.g., `create_app`, `load_user`)
- **Classes**: PascalCase (e.g., `User`, `SurveyResponse`)
- **Constants**: UPPER_SNAKE_CASE (e.g., `MYSQL_HOST`, `APP_NAME`)
- **Templates**: snake_case with descriptive names

## Database Conventions
- **Model Names**: Singular, PascalCase (e.g., `User`, `SurveyResponse`)
- **Table Names**: Automatically generated by SQLAlchemy (lowercase with underscores)
- **Foreign Keys**: `{table}_id` format
- **Timestamps**: `created_at`, `updated_at` fields for audit trails

## Configuration Management
- **Environment-based configs**: Development, Production, Testing classes
- **Environment variables**: All sensitive data via environment variables
- **Default values**: Provided for development convenience
- **Docker environment**: All configs containerized

## Error Handling
- **Custom error pages**: 404.html, 500.html templates
- **Graceful degradation**: Database connection retries (30 attempts)
- **Logging**: Audit logs for admin actions
- **Health checks**: `/health` endpoint for monitoring

## Security Practices
- **JWT Authentication**: Token-based admin access
- **CSRF Protection**: Flask-WTF integration
- **Password Security**: bcrypt hashing
- **Session Security**: HTTP-only, secure cookies
- **Input Validation**: WTForms validation on all forms